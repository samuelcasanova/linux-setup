# Role: keepass
# Description: KeePassXC configuration and dotfiles
# Migrated from: install-software-scripts/70-keepass.sh (config part)

- name: Backup existing KeePassXC configuration
  command: mv {{ item }} /tmp/
  args:
    removes: "{{ item }}"
  loop:
    - ~/.config/keepassxc
    - ~/.config/KeePassXCrc
  failed_when: false

- name: Deploy KeePassXC dotfiles
  command: stow -v -d {{ setup_repo }}/dotfiles/ -t ~ keepass
  args:
    chdir: "{{ setup_repo }}/dotfiles"
  register: stow_keepass
  changed_when: "'LINK' in (stow_keepass.stderr | default(''))"
