---
# Role: git_config
# Description: Configure git with dotfiles
# Migrated from: install-software-scripts/13-git.sh

- name: Backup existing git configuration
  command: mv ~/.gitconfig /tmp/
  args:
    removes: ~/.gitconfig
  failed_when: false

- name: Deploy git dotfiles
  command: stow -v -d {{ setup_repo }}/dotfiles/ -t ~ git
  args:
    chdir: "{{ setup_repo }}/dotfiles"
  register: stow_git
  changed_when: "'LINK' in stow_git.stderr"
